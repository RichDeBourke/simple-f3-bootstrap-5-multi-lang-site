    <script nonce="{{ @nonce }}">
        (function() {
            "use strict";

            const Xeyes = function(irises, padding, lastMouse) {
                this.init(irises, padding, lastMouse);
            };

            function Iris(irisEl) {
                this.iris = irisEl;

                this.width = this.iris.offsetWidth;
                this.height = this.iris.offsetHeight;

                this.resetOffset = function() {
                    let offset = this.iris.getBoundingClientRect();
                    this.offset = {
                        x: offset.left + window.scrollX,
                        y: offset.top + window.scrollY
                    };
                };
            }

            function Eye(irisEl) {
                this.eye = irisEl.parentElement;

                this.width = this.eye.clientWidth;
                this.height = this.eye.clientHeight;

                this.iris = new Iris(irisEl);

                this.pos = {
                    x: (this.width - this.iris.width) / 2,
                    y: (this.height - this.iris.height) / 2
                };

                irisEl.style.setProperty("left", this.pos.x + "px");
                irisEl.style.setProperty("top", this.pos.y + "px");
            }

            Eye.prototype.follow = function(mouse) {
                const localMouse = {
                    x: mouse.x - this.pos.x,
                    y: mouse.y - this.pos.y
                };

                this.iris.resetOffset();

                const deltaX = localMouse.x - this.iris.offset.x;
                const deltaY = localMouse.y - this.iris.offset.y;
                
                // Avoid division by zero
                if (deltaX === 0 && deltaY === 0) return;
                
                const degree = Math.atan2(deltaY, deltaX);
                const maxRadius = (Math.min(this.width, this.height) - Math.max(this.iris.width, this.iris.height)) / 2 - this.padding;
                
                const newX = Math.cos(degree) * maxRadius;
                const newY = Math.sin(degree) * maxRadius;
                
                const distance = Math.sqrt(deltaX * deltaX + deltaY * deltaY);
                
                if (distance <= maxRadius) {
                    // Mouse is within the eye boundary
                    this.iris.iris.style.left = (localMouse.x - this.iris.offset.x + this.pos.x) + "px";
                    this.iris.iris.style.top = (localMouse.y - this.iris.offset.y + this.pos.y) + "px";
                } else {
                    // Mouse is outside, position iris at the boundary
                    this.iris.iris.style.left = (this.pos.x + newX) + "px";
                    this.iris.iris.style.top = (this.pos.y + newY) + "px";
                }
            };

            Xeyes.prototype.init = function(irises, padding, lastMouse) {
                let eyes = [];
                let mousePos = {x: 0, y: 0};
                let animationFrame = null;


                function updateEyes() {
                    eyes.forEach((eye) => eye.follow(mousePos));
                    animationFrame = null;
                }
                
                for (const irisEl of irises) {
                    const eye = new Eye(irisEl);
                    eye.padding = padding;

                    eye.iris.iris.style.setProperty("left", eye.pos.x + "px");
                    eye.iris.iris.style.setProperty("top", eye.pos.y + "px");

                    eyes.push(eye);

                    if (lastMouse && (Object.keys(lastMouse).length === 2)) {
                        eye.follow(lastMouse);
                    }
                }

                window.addEventListener("mousemove", function(event) {
                    mousePos.x = event.pageX;
                    mousePos.y = event.pageY;

                    if (!animationFrame) {
                        animationFrame = requestAnimationFrame(updateEyes);
                    }
                    
                });

            };
            window.Xeyes = Xeyes;
        }());

        if (typeof window.matchMedia === "function") {
            const motionReduce = window.matchMedia("(prefers-reduced-motion: reduce)");

            let lastMouse = {};

            function mousePosition (event) {
                lastMouse = {
                    x: event.pageX,
                    y: event.pageY
                }
            }

            if (motionReduce.matches === false) {
                const irises = document.querySelectorAll(".iris");
                let eyesOpen = false; // setup to listen for the end of the iris animation sequence
                // there are two animations (open & search), so act on the second end.
                
                window.addEventListener("mousemove", mousePosition);

                if (irises.length > 0) { // just to be sure there is an iris, otherwise skip the animation
                    irises[0].addEventListener("animationend", function() {
                        if (!eyesOpen) { // ignore the first end
                            eyesOpen = true;
                        } else {
                            document.querySelector(".mouth").classList.add("oval");
                            setTimeout(() => {
                                document.querySelector(".oops").classList.add("show");
                                const xeyes = new Xeyes(irises, 0, lastMouse);
                                window.removeEventListener("mousemove", mousePosition);
                            }, 500);
                        }
                    });
                }
            }
        }
    </script>